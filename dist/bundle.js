!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.r(t);var a=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasSize=t,this.parent=r,this.canvasArray=[],this.colorsArray=[],this.defaultColor=n}var t,r,a;return t=e,(r=[{key:"showCanvas",value:function(){this.createArrays()}},{key:"createArrays",value:function(){for(var e=0;e<this.canvasSize;e++)this.canvasArray.push(document.createElement("div")),this.canvasArray[e].classList.add("canvas-component"),this.canvasArray[e].style.backgroundColor=this.defaultColor,this.parent.appendChild(this.canvasArray[e]),this.colorsArray.push(this.defaultColor)}},{key:"resetColors",value:function(){for(var e=0;e<this.canvasSize;e++)this.canvasArray[e].style.backgroundColor=this.defaultColor,this.colorsArray[e]=this.defaultColor}},{key:"updateColorsArray",value:function(){for(var e=0;e<this.canvasSize;e++)this.colorsArray[e]=this.canvasArray[e].style.backgroundColor;this.frame.setColors(this.colorsArray)}},{key:"bindFrame",value:function(e){this.frame=e}},{key:"setColors",value:function(e){var t=this;this.colorsArray=e.slice(),this.canvasArray.forEach(function(e,r){e.style.backgroundColor=t.colorsArray[r]})}},{key:"rotateCanvas",value:function(e){this.colorsArray=this.reverseColorsArray(e),this.setColors(this.colorsArray),this.frame.setColors(this.colorsArray)}},{key:"reverseColorsArray",value:function(e){var t=this.getCanvasRows(),r=[];if("flip"===e&&t.forEach(function(e){e.reverse().forEach(function(e){return r.push(e)})}),"rotation"===e)for(var n=0;n<t.length;n++)for(var a=t.length-1;a>=0;a--)r.push(t[a][n]);return r}},{key:"getCanvasRows",value:function(){for(var e=[],t=Math.sqrt(this.canvasSize),r=0;r<t;r++)e.push(this.colorsArray.splice(0,t));return e}}])&&n(t.prototype,r),a&&n(t,a),e}();function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.toolsSection=document.getElementById("tools-holder"),this.pencil=document.getElementById("pencil"),this.erase=document.getElementById("erase"),this.palette=document.getElementById("color-palette"),this.currentColorElem=document.getElementById("current-color"),this.canvasBlock=t,this.canvas=r,this.currentTool="pencil",this.chosenColor="red",this.currentColor=this.chosenColor,this.defaultColor=n,this.isDrawing=!1}var t,r,n;return t=e,(r=[{key:"start",value:function(){this.currentColorElem.style.backgroundColor=this.chosenColor,this.addListeners(),this.addKeyboardListeners()}},{key:"addListeners",value:function(){var e=this;this.toolsSection.addEventListener("click",function(t){return e.changeTool(t)}),this.palette.addEventListener("click",function(t){return e.changeCurrentColor(t)}),document.body.addEventListener("mouseup",function(){return e.stopDrawing()}),this.canvasBlock.addEventListener("mousedown",this),this.canvasBlock.addEventListener("mouseup",this),this.canvasBlock.addEventListener("mouseleave",this)}},{key:"changeTool",value:function(e){var t=e.target;t.classList.contains("tool")&&("pencil"===t.id&&(this.currentTool="pencil",this.currentColor=this.chosenColor),"erase"===t.id&&(this.currentTool="erase",this.currentColor=this.defaultColor),"fill-color"===t.id&&(this.currentTool="fill-color",this.currentColor=this.chosenColor),"flip"===t.id&&(this.currentTool="flip",this.canvas.rotateCanvas(this.currentTool)),"rotation"===t.id&&(this.currentTool="rotation",this.canvas.rotateCanvas(this.currentTool)))}},{key:"changeCurrentColor",value:function(e){var t=e.target;t.classList.contains("color")&&(this.currentColor=t.id,this.currentColorElem.style.backgroundColor=this.currentColor)}},{key:"startDrawing",value:function(e){var t=this;if("fill-color"!==this.currentTool)this.paintCanvasComponent(e.target),this.canvasBlock.addEventListener("mousemove",this);else{var r=e.target.style.backgroundColor;this.canvas.colorsArray.forEach(function(e,n){e===r&&(t.canvas.canvasArray[n].style.backgroundColor=t.currentColor)}),this.endDrawing(),this.canvas.updateColorsArray()}}},{key:"endDrawing",value:function(){this.canvasBlock.removeEventListener("mousemove",this)}},{key:"paintCanvasComponent",value:function(e){var t=e;t.classList.contains("canvas-component")&&(this.isDrawing=!0,t.style.backgroundColor=this.currentColor)}},{key:"stopDrawing",value:function(){this.isDrawing&&this.canvas.updateColorsArray(),this.isDrawing=!1}},{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.startDrawing(e);break;case"mousemove":this.paintCanvasComponent(e.target);break;case"mouseup":case"mouseleave":this.endDrawing();break;default:return}}},{key:"addKeyboardListeners",value:function(){var e=this;document.body.addEventListener("keypress",function(t){var r=e.getChar(t);112===r&&(e.currentTool="pencil",e.currentColor=e.chosenColor),101===r&&(e.currentTool="erase",e.currentColor=e.defaultColor),102===r&&(e.currentTool="fill-color",e.currentColor=e.chosenColor),107===r&&(document.getElementById("shortcut-desc").style.display="block")})}},{key:"getChar",value:function(e){return null==e.which?e.code<32?null:e.code:0!=e.which&&0!=e.code?e.which<32?null:e.which:null}}])&&s(t.prototype,r),n&&s(t,n),e}();function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=n,this.canvasSize=t,this.parent=r,this.canvasComponents=[]}var t,r,n;return t=e,(r=[{key:"showFrame",value:function(e,t){this.createFrame(t),this.buildFrameCanvas(),this.setColors(e),this.addCopyButton(),this.addDeleteButton()}},{key:"createFrame",value:function(e){this.frameHolder=document.createElement("div"),this.frameHolder.classList.add("frame-holder"),e?this.parent.insertBefore(this.frameHolder,e.frameHolder):this.parent.appendChild(this.frameHolder)}},{key:"buildFrameCanvas",value:function(){for(var e=0;e<this.canvasSize;e++)this.canvasComponents.push(document.createElement("div")),this.canvasComponents[e].classList.add("mini-components"),this.frameHolder.appendChild(this.canvasComponents[e])}},{key:"setColors",value:function(e){this.colorsArray=e.slice(),this.canvasComponents.forEach(function(t,r){t.style.backgroundColor=e[r]})}},{key:"addCopyButton",value:function(){this.copyButton=document.createElement("div"),this.copyButton.classList.add("copy-btn"),this.frameHolder.appendChild(this.copyButton)}},{key:"addDeleteButton",value:function(){this.deleteButton=document.createElement("div"),this.deleteButton.classList.add("delete-btn"),this.deleteButton.style.display="none",this.frameHolder.appendChild(this.deleteButton)}},{key:"removeFrame",value:function(){this.frameHolder.remove(),this.deleteButton.remove()}}])&&i(t.prototype,r),n&&i(t,n),e}();function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.animationPreviewHolder=t,this.frames=r,this.canvasSize=n,this.FPS=1,this.index=0}var t,r,n;return t=e,(r=[{key:"startAnimation",value:function(){this.createAnimationCanvas(),this.runAnimationTimer()}},{key:"createAnimationCanvas",value:function(){this.animationFrame=new c(this.canvasSize,this.animationPreviewHolder,this.frames[0].canvas),this.animationFrame.showFrame(this.frames[0].colorsArray);var e=this.animationFrame.frameHolder.getElementsByClassName("copy-btn");this.animationFrame.frameHolder.removeChild(e[0])}},{key:"setFrameColors",value:function(){this.index=(this.index+1)%this.frames.length,this.animationFrame.setColors(this.frames[this.index].colorsArray)}},{key:"runAnimationTimer",value:function(){var e=this;setInterval(function(){return e.setFrameColors()},1e3*this.FPS)}}])&&l(t.prototype,r),n&&l(t,n),e}();function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasBlock=document.getElementById("canvas-holder"),this.framesHolder=document.getElementById("frames-holder"),this.addFrameBtn=document.getElementById("add-frame-btn"),this.defaultColor="ivory",this.canvasSide=32,this.canvasSize=this.canvasSide*this.canvasSide,this.frames=[]}var t,r,n;return t=e,(r=[{key:"start",value:function(){this.canvas=new a(this.canvasSize,this.canvasBlock,this.defaultColor),this.tools=new o(this.canvasBlock,this.canvas,this.defaultColor),this.canvas.showCanvas(),this.tools.start(),this.pushNewFrame(this.frames[this.frames.length-1]),this.addListeners(),this.setFramesToAnimationPreview()}},{key:"pushNewFrame",value:function(){this.canvas.resetColors(),this.createFrame(this.frames.length,this.canvas.colorsArray),this.currentFrameIndex=this.frames.length-1,this.canvas.bindFrame(this.frames[this.currentFrameIndex])}},{key:"createFrame",value:function(e,t){var r=this,n=new c(this.canvasSize,this.framesHolder,this.canvas);this.frames.splice(e,0,n),this.currentFrameIndex=e,n.showFrame(t,this.frames[e+1]),n.deleteButton.addEventListener("click",function(){return r.deleteFrame(n)}),n.copyButton.addEventListener("click",function(){return r.copyFrame(n)}),n.frameHolder.addEventListener("click",function(e){return r.changeCurrentFrame(e,n)}),this.checkFramesCount()}},{key:"checkFramesCount",value:function(){var e=this.frames.length>1?"":"none";this.frames.forEach(function(t){t.deleteButton.style.display=e})}},{key:"deleteFrame",value:function(e){var t=this.frames.indexOf(e);this.frames[t].removeFrame(),this.frames.splice(t,1),this.checkFramesCount(),(t===this.currentFrameIndex&&t===this.frames.length||t<this.currentFrameIndex)&&(this.currentFrameIndex-=1),this.canvas.bindFrame(this.frames[this.currentFrameIndex]),this.canvas.setColors(this.frames[this.currentFrameIndex].colorsArray)}},{key:"copyFrame",value:function(e){var t=this.frames.indexOf(e,0);this.createFrame(t+1,this.frames[t].colorsArray),this.canvas.setColors(this.frames[t].colorsArray),this.canvas.bindFrame(this.frames[t+1]),this.currentFrameIndex=t+1}},{key:"addListeners",value:function(){var e=this;this.addFrameBtn.addEventListener("click",function(){return e.pushNewFrame()})}},{key:"changeCurrentFrame",value:function(e,t){var r=e.target;"frame-holder"!==r.className&&"mini-components"!==r.className||(this.canvas.setColors(t.colorsArray),this.canvas.bindFrame(t),this.currentFrameIndex=this.frames.indexOf(t))}},{key:"setFramesToAnimationPreview",value:function(){var e=document.getElementById("screen");this.animationPreview=new u(e,this.frames,this.canvasSize),this.animationPreview.startAnimation()}}])&&h(t.prototype,r),n&&h(t,n),e}())).start()}]);